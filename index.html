<!-- Reemplaza SOLO la función exportarPDF() por esta versión mejorada -->
<script>
function exportarPDF() {
  const element = document.body;

  html2canvas(element, {
    scale: 2, // Mayor calidad
    useCORS: true,
    allowTaint: true
  }).then(canvas => {
    const imgData = canvas.toDataURL('image/png');
    const pdf = new jspdf.jsPDF('p', 'mm', 'a4'); // Portrait, A4
    const pageWidth = 210; // A4 width in mm
    const pageHeight = 297; // A4 height in mm

    // Calcular proporción
    const imgWidth = pageWidth - 20; // Margen de 10mm a cada lado
    const imgHeight = (canvas.height * imgWidth) / canvas.width;

    // Si el contenido es más alto que una página, podríamos dividirlo, pero para tu caso, asumimos 1 página
    if (imgHeight < pageHeight - 20) {
      // Cabe en una página
      pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);
    } else {
      // Escalar para que quepa en altura también (forzado a 1 página)
      const scaleToFit = (pageHeight - 20) / imgHeight;
      const finalWidth = imgWidth * scaleToFit;
      const finalX = (pageWidth - finalWidth) / 2;
      pdf.addImage(imgData, 'PNG', finalX, 10, finalWidth, pageHeight - 20);
    }

    pdf.save('NILES_Cedula_Completa.pdf');
  });
}
</script>
